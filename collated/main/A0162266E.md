# A0162266E
###### \java\werkbook\task\commons\events\storage\TaskListStorageChangedEvent.java
``` java
package werkbook.task.commons.events.storage;

import werkbook.task.commons.events.BaseEvent;

/**
 * Indicates the storage location of the TaskList has changed
 */
public class TaskListStorageChangedEvent extends BaseEvent {

    public String newPath;

    public TaskListStorageChangedEvent(String newPath) {
        this.newPath = newPath;
    }

    @Override
    public String toString() {
        return "tasklist.xml now saved at " + newPath;
    }

}
```
###### \java\werkbook\task\logic\commands\SaveCommand.java
``` java
package werkbook.task.logic.commands;

import java.io.IOException;
import java.nio.file.Files;
import java.nio.file.Path;

import werkbook.task.commons.exceptions.IllegalValueException;
import werkbook.task.logic.commands.exceptions.CommandException;

/**
 * Change the save location of the task list
 */
public class SaveCommand extends Command {

    public static final String COMMAND_WORD = "save";

    public static final String MESSAGE_USAGE = COMMAND_WORD + ": Changes the save location of the tasks.\n"
            + "The folder path can be relative or absolute.\n"
            + "Parameters: Save Folder Path"
            + "Example: " + COMMAND_WORD
            + " ./NewSaveFolder";

    public static final String MESSAGE_SUCCESS = "Save location changed successfully";
    public static final String MESSAGE_INVALID_PATH = "Specified folder is invalid";
    public static final String MESSAGE_FOLDER_NOT_EXIST = "Specified folder does not exist";
    public static final String MESSAGE_NOT_A_DIRECTORY = "Specified path is not a folder";
    public static final String MESSAGE_DIRECTORY_NOT_WRITABLE = "Specifed folder is not writable";
    public static final String MESSAGE_IO_ERROR = "Error writing to file";

    private final Path newPath;
    /**
     * Creates a SaveCommand using specified path.
     *
     * @throws IllegalValueException if the path is invalid
     */
    public SaveCommand(Path path)
        throws IllegalValueException {
        if (!Files.exists(path)) {
            throw new IllegalValueException(MESSAGE_FOLDER_NOT_EXIST);
        } else if (!Files.isDirectory(path)) {
            throw new IllegalValueException(MESSAGE_NOT_A_DIRECTORY);
        } else if (!Files.isWritable(path)) {
            throw new IllegalValueException(MESSAGE_DIRECTORY_NOT_WRITABLE);
        }

        this.newPath = path.resolve("tasklist.xml");
    }

    @Override
    public CommandResult execute() throws CommandException {
        try {
            storage.setTaskListFilePath(this.newPath);
            model.indicateTaskListChanged();
        } catch (IOException e) {
            return new CommandResult(MESSAGE_IO_ERROR);
        }
        return new CommandResult(MESSAGE_SUCCESS);

    }

    @Override
    public boolean isMutable() {
        return false;
    }
}
```
###### \java\werkbook\task\logic\parser\ParserUtil.java
``` java
    /**
     * Parses a {@code Optional<String> Path} into an {@code Optional<Path>} if
     * {@code path} is present.
     */
    public static Optional<Path> parsePath(String path) {
        assert path != null;
        return !path.equals("") ? Optional.of(Paths.get(path.trim())) : Optional.empty();
    }

```
###### \java\werkbook\task\logic\parser\SaveCommandParser.java
``` java
package werkbook.task.logic.parser;

import static werkbook.task.commons.core.Messages.MESSAGE_INVALID_COMMAND_FORMAT;

import java.nio.file.InvalidPathException;
import java.nio.file.Path;
import java.util.Optional;

import werkbook.task.commons.exceptions.IllegalValueException;
import werkbook.task.logic.commands.Command;
import werkbook.task.logic.commands.IncorrectCommand;
import werkbook.task.logic.commands.SaveCommand;

/**
 * Parses input arguments and creates a new SaveCommand object
 */
public class SaveCommandParser {

    /**
     * Parses the given {@code String} of arguments in the context of the SaveCommand
     * and returns an SaveCommand object for execution.
     */
    public Command parse(String args) {
        Optional<Path> path;
        try {
            path = ParserUtil.parsePath(args);
        } catch (InvalidPathException IPE) {
            return new IncorrectCommand(SaveCommand.MESSAGE_INVALID_PATH);
        }
        if (!path.isPresent()) {
            return new IncorrectCommand(
                    String.format(MESSAGE_INVALID_COMMAND_FORMAT, SaveCommand.MESSAGE_USAGE));
        }
        try {
            return new SaveCommand(path.get());
        } catch (IllegalValueException ive) {
            return new IncorrectCommand(ive.getMessage());
        }
    }
}
```
###### \java\werkbook\task\storage\StorageManager.java
``` java
    // ================ Config methods =================================
    @Override
    public void setTaskListFilePath(Path filePath) throws IOException {
        this.taskListStorage = new XmlTaskListStorage(filePath.toString());
        config.setTaskListFilePath(filePath.toString());
        ConfigUtil.saveConfig(config, Config.DEFAULT_CONFIG_FILE);
        raise(new TaskListStorageChangedEvent(filePath.toString()));
    }
```
###### \java\werkbook\task\ui\StatusBarFooter.java
``` java
    @Subscribe
    public void handleTaskListStorageChangedEvent(TaskListStorageChangedEvent tlsce) {
        setSaveLocation(tlsce.newPath);
    }
```
